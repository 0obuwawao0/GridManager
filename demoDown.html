<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script type="text/javascript" language="javascript">
        var idTmr;
		var tableToExcel = function() {			
			var table = document.getElementById('targetTable');
			var ctx = table.innerHTML;
			  var uri = 'data:application/vnd.ms-excel;base64,',
			  template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body><table>'+ctx+'</table></body></html>';
				var base64 = function(s) { 
					return window.btoa(unescape(encodeURIComponent(s)))
				}
					var test2 = document.getElementById('test2');
					console.log(template)
				//	test2.setAttribute('href', uri + base64(template));
				//	test2.click();
				//	window.location.href = uri + base64(format(template, ctx))
					window.open( uri + base64(template))
			 
			}
    </script>

</head>
<body>
<table id="targetTable">
	<thead>
	  <tr align="center">
		<th>大柳塔顶替七</th>
		<th>大柳塔顶替七</th>
		<th>大柳塔顶替七</th>
		<th>大柳塔顶替七</th>
		<th>大柳塔顶替七</th>
		<th>大柳塔顶替七</th>
		<th>大柳塔顶替七</th>
	  </tr>
	</thead>
	<tbody>
  <tr align="center">
	<td>1</td>
	<td>大柳塔顶替七</td>
	<td>2015-07-22</td>
	<td>2015adsf@#%#%&#%*GBDADFA^WRTUGFDFG$%^&(^&%*)(%&(,-07-22</td>
	<td>2015-07-22</td>
	<td>ba,,ukh</td>
	<td>1,</td>
  </tr>
  <tr align="center">
	<td>2</td>
	<td>大柳塔顶替七</td>
	<td>2015-07-22</td>
	<td>201,,5-07-22</td>
	<td>2015-07-22</td>
	<td>b,...ukh</td>
	<td>1</td>
  </tr>
  </tbody>
</table>
</br>
<input id="Button1" type="button" value="下载Excel" 
        onclick="tableToExcel('targetTable')" />
		<a href="" download="abc.xls" id="test2"></a>
</body>
</html>